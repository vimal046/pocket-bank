<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8" />
<title>All Accounts - PocketBank Admin</title>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
	rel="stylesheet" />
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css"
	rel="stylesheet" />
<style>
body {
	background: #f5f7fa;
	font-family: "Segoe UI";
}

.main-container {
	max-width: 1400px;
	margin: 0 auto;
	padding: 20px;
}

.card {
	border-radius: 12px;
	box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}
</style>
</head>
<body>
	<nav class="navbar navbar-expand-lg bg-dark navbar-dark">
		<div class="container-fluid main-container">
			<a class="navbar-brand" href="/admin/dashboard"><i
				class="bi bi-bank2"></i> PocketBank Admin</a>
			<div class="navbar-nav ms-auto">
				<a class="nav-link" href="/admin/dashboard">Dashboard</a> <a
					class="nav-link" href="/admin/users">Users</a> <a
					class="nav-link active" href="/admin/accounts">Accounts</a> <a
					class="nav-link" href="/admin/loans">Loans</a>
			</div>
		</div>
	</nav>

	<div class="main-container mt-4">
		<div class="d-flex justify-content-between align-items-center mb-4">
			<h2>
				<i class="bi bi-wallet2"></i> All Accounts
			</h2>
			<a href="/admin/accounts/pending" class="btn btn-warning"> <i
				class="bi bi-hourglass-split"></i> View Pending Accounts
			</a>
		</div>

		<div th:if="${success}" class="alert alert-success alert-dismissible">
			<span th:text="${success}"></span>
			<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
		</div>

		<div class="card">
			<div class="card-body">
				<table class="table table-hover">
					<thead>
						<tr>
							<th>Account Number</th>
							<th>Type</th>
							<th>Customer</th>
							<th>Balance</th>
							<th>Status</th>
							<th>Created Date</th>
							<th>Actions</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="account : ${accounts}">
							<td th:text="${account.accountNumber}"></td>
							<td><span class="badge bg-info"
								th:text="${account.accountType}"></span></td>
							<td th:text="${account.user.fullName}"></td>
							<td
								th:text="'â‚¹' + ${#numbers.formatDecimal(account.balance, 0, 'COMMA', 2, 'POINT')}"></td>
							<td><span class="badge"
								th:with="status=${account.status.name()}"
								th:classappend="${status == 'APPROVED' 
                   ? ' bg-success' 
                   : status == 'PENDING' 
                     ? ' bg-warning' 
                     : ' bg-danger'}"
								th:text="${status}"> </span></td>
							<td
								th:text="${#temporals.format(account.createdAt, 'dd-MM-yyyy')}"></td>
							<td><a th:href="@{'/admin/users/' + ${account.user.id}}"
								class="btn btn-sm btn-info"> <i
									class="bi bi-eye"></i> View User
							</a>
								<form th:if="${account.status == 'APPROVED'}"
									th:action="@{'/admin/accounts/' + ${account.id} + '/suspend'}"
									method="post" style="display: inline">
									<button type="submit" class="btn btn-sm btn-danger"
										onclick="return confirm('Are you sure you want to suspend this account?')">
										<i class="bi bi-x-circle"></i> Suspend
									</button>
								</form></td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
	</div>

	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
