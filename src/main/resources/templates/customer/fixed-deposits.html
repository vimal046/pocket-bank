<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8" />
<title>Fixed Deposits - PocketBank</title>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
	rel="stylesheet" />
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css"
	rel="stylesheet" />
<style>
body {
	background: #f5f7fa;
	font-family: "Segoe UI";
}

.main-container {
	max-width: 1200px;
	margin: 0 auto;
	padding: 20px;
}

.card {
	border-radius: 12px;
	box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
	margin-bottom: 20px;
}
</style>
</head>
<body>
	<nav class="navbar navbar-expand-lg bg-light">
		<div class="container-fluid main-container">
			<a class="navbar-brand" href=""><i
				class="bi bi-bank2"></i> PocketBank</a>
			<div class="navbar-nav ms-auto">
				<a class="nav-link" href="/customer/dashboard">Dashboard</a>
			</div>
		</div>
	</nav>

	<div class="main-container mt-4">
		<div class="d-flex justify-content-between align-items-center mb-4">
			<h2>
				<i class="bi bi-piggy-bank"></i> My Fixed Deposits
			</h2>
			<button class="btn btn-success" data-bs-toggle="modal"
				data-bs-target="#createFdModal">
				<i class="bi bi-plus-circle"></i> Create Fixed Deposit
			</button>
		</div>

		<div th:if="${success}" class="alert alert-success alert-dismissible">
			<span th:text="${success}"></span>
			<button type="button" class="btn-close" data-bs-dismiss="alert"></button>
		</div>

		<!-- FD List -->
		<div class="row">
			<div class="col-md-6" th:each="fd : ${fixedDeposits}">
				<div class="card">
					<div class="card-body">
						<div class="d-flex justify-content-between mb-2">
							<h5>
								<i class="bi bi-graph-up-arrow"></i> Fixed Deposit
							</h5>
							<span class="badge"
								th:classappend="${fd.status.name() == 'ACTIVE'
      ? 'bg-success'
      : fd.status.name() == 'MATURED'
      ? 'bg-info'
      : 'bg-secondary'}"
								th:text="${fd.status}"> </span>
						</div>

						<div class="row text-center mb-3">
							<div class="col-6">
								<small class="text-muted">Principal</small>
								<h4
									th:text="'₹' + ${#numbers.formatDecimal(fd.principalAmount, 0, 'COMMA', 0, 'POINT')}"></h4>
							</div>
							<div class="col-6">
								<small class="text-muted">Maturity Amount</small>
								<h4 class="text-success"
									th:text="'₹' + ${#numbers.formatDecimal(fd.maturityAmount, 0, 'COMMA', 0, 'POINT')}"></h4>
							</div>
						</div>

						<hr />

						<div class="row text-center">
							<div class="col-4">
								<small class="text-muted">Tenure</small>
								<p class="mb-0">
									<strong th:text="${fd.tenureMonths} + ' months'"></strong>
								</p>
							</div>
							<div class="col-4">
								<small class="text-muted">Interest Rate</small>
								<p class="mb-0">
									<strong th:text="${fd.interestRate} + '%'"></strong>
								</p>
							</div>
							<div class="col-4">
								<small class="text-muted">Returns</small>
								<p class="mb-0 text-success">
									<strong
										th:text="'₹' + ${#numbers.formatDecimal(fd.maturityAmount - fd.principalAmount, 0, 'COMMA', 0, 'POINT')}"></strong>
								</p>
							</div>
						</div>

						<hr />

						<p class="mb-1">
							<small class="text-muted">Start Date:
								<span th:text="${#temporals.format(fd.startDate, 'dd-MM-yyyy')}"></span>
							</small>
						</p>
						<p class="mb-0">
							<small class="text-muted">Maturity
								Date: <span
								th:text="${#temporals.format(fd.maturityDate, 'dd-MM-yyyy')}"></span>
							</small>
						</p>
					</div>
				</div>
			</div>
		</div>

		<div th:if="${fixedDeposits.empty}"
			class="text-center text-muted py-5">
			<i class="bi bi-inbox" style="font-size: 4rem"></i>
			<p>No fixed deposits yet. Create one to start growing your
				wealth!</p>
		</div>
	</div>

	<!-- Create FD Modal -->
	<div class="modal fade" id="createFdModal" tabindex="-1">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<h5 class="modal-title">Create Fixed Deposit</h5>
					<button type="button" class="btn-close" data-bs-dismiss="modal"></button>
				</div>
				<form th:action="@{/customer/fixed-deposits/create}" method="post">
					<div class="modal-body">
						<div class="mb-3">
							<label class="form-label">Select
								Account (to deduct amount)</label> <select name="accountNumber"
								class="form-select" required>
								<option value="">Choose account...</option>
								<option th:each="acc : ${accounts}"
									th:value="${acc.accountNumber}"
									th:text="${acc.accountType + ' - ' + acc.accountNumber + ' (₹' + #numbers.formatDecimal(acc.balance, 0, 'COMMA', 2, 'POINT') + ')'}"></option>
							</select>
						</div>

						<div class="mb-3">
							<label class="form-label">Principal Amount (₹)</label> <input
								type="number" name="principalAmount" class="form-control"
								min="5000" step="1000" required /> <small
								class="text-muted">Minimum: ₹5,000</small>
						</div>

						<div class="mb-3">
							<label class="form-label">Tenure (Months)</label> <select
								name="tenureMonths" class="form-select" required>
								<option value="6">6 Months (5.5% interest)</option>
								<option value="12">12 Months (6.0% interest)</option>
								<option value="24">24 Months (6.5% interest)</option>
								<option value="36">36 Months (7.0% interest)</option>
							</select>
						</div>

						<div class="alert alert-info">
							<i class="bi bi-info-circle"></i> The amount will be deducted
							from your selected account immediately.
						</div>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary"
							data-bs-dismiss="modal">Cancel</button>
						<button type="submit" class="btn btn-success">Create FD</button>
					</div>
				</form>
			</div>
		</div>
	</div>

	<script
		src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
